
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Elaborate flood data - DH Hub</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/colors.css">
    
      <link rel="stylesheet" href="../../stylesheets/template-metadata.css">
    
      <link rel="stylesheet" href="../../stylesheets/template-page.css">
    
      <link rel="stylesheet" href="../../stylesheets/overrides.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="orange" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#elaborate-flood-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DH Hub" class="md-header__button md-logo" aria-label="DH Hub" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DH Hub
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Elaborate flood data
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="orange" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DH Hub" class="md-nav__button md-logo" aria-label="DH Hub" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DH Hub
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Catalogs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Catalogs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definition" class="md-nav__link">
    <span class="md-ellipsis">
      Definition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    <span class="md-ellipsis">
      Environment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="template-title">Elaborate Flood Data</div>
<div id="template-content">
<div id="template-metadata">
<div id="template-metadata-right"><a class="md-cell-right" id=md-repo-directory href="https://github.com/scc-digitalhub/hub/tree/main/catalog/functions/elaborate-flood-data">View directory</a><a class="md-cell-right" id=md-repo-definition href="https://raw.githubusercontent.com/scc-digitalhub/hub/refs/heads/main/catalog/functions/elaborate-flood-data/definition.yaml">Definition</a><div class="md-cell-right" id="hub-ref"><button id="hub-ref-text" class="hub-ref-button" onclick="toggleRef()">Reference <span id="hub-ref-icon">&#x25BC;</span></button><div id="hub-ref-link"><span id=hub-ref-link-text>hub://functions/elaborate-flood-data:0.14.6</span><button id=hub-ref-link-button onclick="copyRef()">Copy</button></div>
</div>
</div>
<div id="template-metadata-left">
<div class="md-cell">
<div class="md-cell-title">Name</div>
<div class="md-cell-content" id="md-name">Elaborate Flood Data</div>
</div>
<div class="md-cell">
<div class="md-cell-title">Description</div>
<div class="md-cell-content" id="md-description">Function to elaborate flood data using Sentinel-1 and Sentinel-2 imagery</div>
</div>
<div class="md-cell">
<div class="md-cell-title">Version</div>
<div class="md-cell-content" id="md-version">0.14.6</div>
</div>
<div class="md-cell">
<div class="md-cell-title">Labels</div>
<div class="md-cell-content" id="md-labels"><span class="md-label label-license">apache-2.0</span><span class="md-label label-domain">geo</span><span class="md-label label-application">pa</span><span class="md-label label-aspect">security</span><span class="md-label label-platform">0.14</span><span class="md-label label-type">job</span><span class="md-label label-phase">feature-extraction</span></div>
</div>
</div>
</div>
<div id="template-tab-buttons"><button class="tab-button tab-button-selected" id="tab-button-usage" onclick="openTab('usage')">Usage</button></div>
<div id="template-info">
<div class="template-info-tab" id="template-usage">
<h1 id="elaborate-flood-data">Elaborate Flood Data</h1>
<p>This function performs flood analysis using Sentinel satellite data to assess flood extent and impact. It processes raw .SAFE or .zip Sentinel inputs, computes water indices, predicts water before and after a flood event, and outputs flood detection layer.</p>
<p>The function provides complete workflow for
- Ingesting Sentinel-1 (scene-based) and Sentinel-2 (tile-based) data using product-specific metadata.
- Perform elaboration
- Compute NDWI indices from Sentinel-2 imagery to detect water bodies before and after the flood event.
- Calculate flood extent by analyzing pre- and post-event backscatter differences from Sentinel-1 data
- Combine both results from Sentinel-1 and Sentinel-2 to have one flood prediction layer.
- Post-process change maps to improve the results by masking permanent water bodies.
- Log results as GeoTIFF raster files Raster and vector outputs.</p>
<p>The function is implemented as a container that allows you to deploy deployments, jobs and services on Kubernetes. It uses the base image with gdal, snapista, and scikit-learn libaries installed and pre configured. It further runs the launch instructions specified by 'launch.sh' file. </p>
<h2 id="definition">Definition</h2>
<p>The function accepts a list of positional arguments that are passed directly to the Docker container. These parameters control Sentinel data selection, temporal configuration, output aritifact, and AOI geometry. These arguments are passed to the container’s entrypoint script.</p>
<p>These arguments define inputs, geospatial filters, auxiliary data, processing parameters, and scenario metadata.</p>
<table>
<thead>
<tr>
<th>Pos</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>/shared/launch.sh</code></td>
<td>Entrypoint script executed in the container.</td>
</tr>
<tr>
<td>2</td>
<td><code>sentinel1_GRD_preflood</code></td>
<td>Sentinel-1 GRD logged artifact name for the pre-flood period.</td>
</tr>
<tr>
<td>3</td>
<td><code>sentinel1_GRD_postflood</code></td>
<td>Sentinel-1 GRD logged artifact name for the post-flood period.</td>
</tr>
<tr>
<td>4</td>
<td><code>sentinel2_pre_flood</code></td>
<td>Sentinel-2 logged artifact name for the pre-flood period.</td>
</tr>
<tr>
<td>5</td>
<td><code>sentinel2_post_flood</code></td>
<td>Sentinel-2 logged artifact name for the post-flood period.</td>
</tr>
<tr>
<td>6</td>
<td><code>POLYGON ((...))</code></td>
<td>WKT geometry defining AOI for flood analysis.</td>
</tr>
<tr>
<td>7</td>
<td><code>Slopes_TN</code></td>
<td>Logged artifact name of slope map resources.</td>
</tr>
<tr>
<td>8</td>
<td><code>trentino_slope_map.tif</code></td>
<td>Name of Slope raster file inside 'Slopes_TN' artifact.</td>
</tr>
<tr>
<td>9</td>
<td><code>Lakes_TN</code></td>
<td>Loggged Artifact name for lake datasets.</td>
</tr>
<tr>
<td>10</td>
<td><code>idrspacq.shp</code></td>
<td>Name of specific Lake shapefile inside 'Lakes_TN' artifact</td>
</tr>
<tr>
<td>11</td>
<td><code>Rivers_TN</code></td>
<td>Logged artifact name for river datasets.</td>
</tr>
<tr>
<td>12</td>
<td><code>cif_pta2022_v.shp</code></td>
<td>Name of River network shapefile inside 'Rivers_TN' artifact.</td>
</tr>
<tr>
<td>13</td>
<td><code>garda_oct_2020</code></td>
<td>output name</td>
</tr>
<tr>
<td>14</td>
<td><code>2020-10-02</code></td>
<td>Event date of flood.</td>
</tr>
<tr>
<td>15</td>
<td><code>EPSG:25832</code></td>
<td>Spatial reference system for output products.</td>
</tr>
<tr>
<td>16</td>
<td><code>['VV','VH']</code></td>
<td>Sentinel-1 polarizations to process.</td>
</tr>
<tr>
<td>17</td>
<td><code>700</code></td>
<td>Processing threshold (e.g., buffer, intensity, or scale parameter).</td>
</tr>
<tr>
<td>18</td>
<td><code>7</code></td>
<td>Filter/window size parameter.</td>
</tr>
<tr>
<td>19</td>
<td><code>15</code></td>
<td>Processing radius or kernel size.</td>
</tr>
<tr>
<td>20</td>
<td><code>2</code></td>
<td>Flood-level classification/threshold parameter.</td>
</tr>
<tr>
<td>21</td>
<td><code>val di fassa</code></td>
<td>Region name used for contextual labeling.</td>
</tr>
</tbody>
</table>
<p>Example</p>
<p>The following command launches the elaborate function as a containerized job, providing compute resources, storage volumes, and runtime arguments.</p>
<div class="highlight"><pre><span></span><code>run_el = function_rs.run(
    action=&quot;job&quot;,
    fs_group=&#39;8877&#39;,
    resources={
         &quot;cpu&quot;: &quot;6&quot;,
         &quot;mem&quot;: &quot;64Gi&quot;
    },
    volumes=[{
        &quot;volume_type&quot;: &quot;persistent_volume_claim&quot;,
        &quot;name&quot;: &quot;volume-flood&quot;,
        &quot;mount_path&quot;: &quot;/app/data&quot;,
        &quot;spec&quot;: { &quot;size&quot;: &quot;100Gi&quot; }
    }],
    args=[
        &#39;/shared/launch.sh&#39;,
        &#39;sentinel1_GRD_preflood&#39;,
        &#39;sentinel1_GRD_postflood&#39;,
        &#39;sentinel2_pre_flood&#39;,
        &#39;sentinel2_post_flood&#39;,
        &#39;POLYGON ((10.644988646837982 45.85539621678084, 10.644988646837982 46.06780100571985, 10.991744628283294 46.06780100571985, 10.991744628283294 45.85539621678084, 10.644988646837982 45.85539621678084))&#39;,
        &#39;Slopes_TN&#39;,
        &#39;trentino_slope_map.tif&#39;,
        &#39;Lakes_TN&#39;,
        &#39;idrspacq.shp&#39;,
        &#39;Rivers_TN&#39;,
        &#39;cif_pta2022_v.shp&#39;,
        &#39;garda_oct_2020&#39;,
        &#39;2020-10-02&#39;,
        &#39;EPSG:25832&#39;,
        &quot;[&#39;VV&#39;,&#39;VH&#39;]&quot;,
        &#39;700&#39;,
        &#39;7&#39;,
        &#39;15&#39;,
        &#39;2&#39;,
        &#39;val di fassa&#39;
        ]
    )
</code></pre></div>
<h2 id="usage">Usage</h2>
<p>The function expects an entry point launch script as shown below giving user the possibility to configure the runtime environment prior to elaboration. It further runs the launch instructions specified by 'launch.sh' file. </p>
<div class="highlight"><pre><span></span><code>%#!/bin/bash
ls -la /shared
cd ~
pwd
source .bashrc
export PATH=&quot;/home/nonroot/miniforge3/snap/bin:$PATH&quot;
export PROJ_LIB=/home/nonroot/miniforge3/share/proj
export GDAL_DATA=/home/nonroot/miniforge3/share/gdal
export GDAL_DRIVER_PATH=/home/nonroot/miniforge3/lib/gdalplugins
export PROJ_DATA=/home/nonroot/miniforge3/share/proj
gdal-config --version
python --version
echo &quot;GDAL DATA AFTER EXPORT:&quot;
echo $GDAL_DATA
echo &quot;PROJ_LIB AFTER EXPORT&quot;
echo $PROJ_LIB
echo &quot;Running flood mapping script with parameters:&quot;
echo &quot;{&#39;s1PreFlood&#39;: &#39;$1&#39;, &#39;s1PostFlood&#39;:&#39;$2&#39;, &#39;s2PreFlood&#39;:&#39;$3&#39;,&#39;s2PostFlood&#39;:&#39;$4&#39;,&#39;geomWKT&#39;:&#39;$5&#39;,&#39;slopeArtifact&#39;:&#39;$6&#39;,&#39;slopeFileName&#39;:&#39;$7&#39;,&#39;lakeShapeArtifactName&#39;:&#39;$8&#39;,&#39;lakeShapeFileName&#39;:&#39;$9&#39;,&#39;riverShapeArtifactName&#39;:&#39;${10}&#39;,&#39;riverShapeFileName&#39;:&#39;${11}&#39;,&#39;output&#39;:&#39;${12}&#39;,&#39;eventDate&#39;:&#39;${13}&#39;,&#39;targetCRS&#39;:&#39;${14}&#39;,&#39;polarization&#39;:${15},&#39;dem_threshold&#39;:${16},&#39;slope_threshold&#39;:${17},&#39;noise_min_pixels&#39;:${18},&#39;river_buffer_meters&#39;:${19}}, &#39;aoi_name&#39;:&#39;${20}&#39;}&quot;
cd /app
python main.py &quot;{&#39;s1PreFlood&#39;:&#39;$1&#39;, &#39;s1PostFlood&#39;:&#39;$2&#39;, &#39;s2PreFlood&#39;:&#39;$3&#39;,&#39;s2PostFlood&#39;:&#39;$4&#39;,&#39;geomWKT&#39;:&#39;$5&#39;,&#39;slopeArtifact&#39;:&#39;$6&#39;,&#39;slopeFileName&#39;:&#39;$7&#39;,&#39;lakeShapeArtifactName&#39;:&#39;$8&#39;,&#39;lakeShapeFileName&#39;:&#39;$9&#39;,&#39;riverShapeArtifactName&#39;:&#39;${10}&#39;,&#39;riverShapeFileName&#39;:&#39;${11}&#39;,&#39;output&#39;:&#39;${12}&#39;,&#39;eventDate&#39;:&#39;${13}&#39;,&#39;targetCRS&#39;:&#39;${14}&#39;,&#39;polarization&#39;:${15},&#39;dem_threshold&#39;:${16},&#39;slope_threshold&#39;:${17},&#39;noise_min_pixels&#39;:${18},&#39;river_buffer_meters&#39;:${19}, &#39;aoi_name&#39;:&#39;${20}&#39;}&quot;
exit
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>function_elaborate = proj.new_function(&quot;elaborate&quot;,kind=&quot;container&quot;, image=&quot;ghcr.io/tn-aixpa/rs-flood-mapping:0.14.6&quot;, command=&quot;/bin/bash&quot;, code_src=&quot;launch.sh&quot;)
</code></pre></div>
Notes: For detailed usage see the usage notebook.</p>
<h2 id="environment">Environment</h2>
<p>The runtime environment of function consist of properties which are configured in the bash script created in previous section
- PATH
- PROJ_LIB
- GDAL_DATA
- GDAL_DRIVER_PATH
- PROJ_DATA</p>
<p><div class="highlight"><pre><span></span><code>function_elaborate.run(
    action=&quot;job&quot;,
    fs_group=&#39;8877&#39;,
    resources={
         &quot;cpu&quot;: &quot;6&quot;,
         &quot;mem&quot;: &quot;64Gi&quot;
    },
    volumes=[{
        &quot;volume_type&quot;: &quot;persistent_volume_claim&quot;,
        &quot;name&quot;: &quot;volume-flood&quot;,
        &quot;mount_path&quot;: &quot;/app/data&quot;,
        &quot;spec&quot;: { &quot;size&quot;: &quot;100Gi&quot; }
    }],
    args=[
        &#39;/shared/launch.sh&#39;,
        &#39;sentinel1_GRD_preflood&#39;,
        &#39;sentinel1_GRD_postflood&#39;,
        &#39;sentinel2_pre_flood&#39;,
        &#39;sentinel2_post_flood&#39;,
        &#39;POLYGON ((10.644988646837982 45.85539621678084, 10.644988646837982 46.06780100571985, 10.991744628283294 46.06780100571985, 10.991744628283294 45.85539621678084, 10.644988646837982 45.85539621678084))&#39;,
        &#39;Slopes_TN&#39;,
        &#39;trentino_slope_map.tif&#39;,
        &#39;Lakes_TN&#39;,
        &#39;idrspacq.shp&#39;,
        &#39;Rivers_TN&#39;,
        &#39;cif_pta2022_v.shp&#39;,
        &#39;garda_oct_2020&#39;,
        &#39;2020-10-02&#39;,
        &#39;EPSG:25832&#39;,
        &quot;[&#39;VV&#39;,&#39;VH&#39;]&quot;,
        &#39;700&#39;,
        &#39;7&#39;,
        &#39;15&#39;,
        &#39;2&#39;,
        &#39;val di fassa&#39;
        ]
    )
</code></pre></div>
To avoid capacity issues the environment variable "TMPDIR" for this function execution is set to same path of volume mount. As a general confromance to best practice approach, the container runtime is executed as non root user(fs_group='8877')</p>
<h2 id="resources">Resources</h2>
<p>These settings define the resource requests and limits for the container runtime.</p>
<table>
<thead>
<tr>
<th>Resource</th>
<th>Requests</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CPU</strong></td>
<td><code>6</code></td>
<td>CPU cores allocated to the job.</td>
</tr>
<tr>
<td><strong>Memory</strong></td>
<td><code>64Gi</code></td>
<td>Memory available to the container.</td>
</tr>
</tbody>
</table>
<p>The job mounts a persistent storage volume used for reading/writing large datasets (e.g., Sentinel images).</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>volume_type</code></td>
<td><code>persistent_volume_claim</code></td>
<td>Indicates a persistent storage resource.</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>volume-flood</code></td>
<td>Volume identifier.</td>
</tr>
<tr>
<td><code>mount_path</code></td>
<td><code>/app/files</code></td>
<td>Directory inside the container where the volume is mounted.</td>
</tr>
<tr>
<td><code>size</code></td>
<td><code>100Gi</code></td>
<td>Allocated storage capacity.</td>
</tr>
</tbody>
</table>
<p>'elaboration' function consists of interpolation and post processing steps which are computationally heavy since it is pixel based analysis. The amount of sentinal data is huge that is why a default volume of 100Gi of type 'persistent_volume_claim' is specified to ensure significant data spacetake several hours to complete with 16 CPUs and 64GB Ram for processing data window around flood event date (±20 days sentinel-2 data and ± 7days Sentinel-1 data) which is the default period.</p>
</div>
</div>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.path", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>