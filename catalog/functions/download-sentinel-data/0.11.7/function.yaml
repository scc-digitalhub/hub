name: download-sentinel-data
kind: container+job:run
metadata:
  name: download-sentinel-data
  description: "Function for Sentinel image download and preprocessing"  
  version: latest
  labels:
    - Remote Sensing
spec:
  args:
    - main.py
    - '{"satelliteParams":{"satelliteType": "Sentinel1","processingLevel":
      "LEVEL1","sensorMode": "IW","productType": "SLC","orbitDirection":
      "DESCENDING","relativeOrbitNumber": "168"},"startDate":
      "2021-10-01","endDate": "2022-01-01","geometry": "POLYGON ((10.595369
      45.923394, 10.644894 45.923394, 10.644894 45.945838, 10.595369 45.945838,
      10.595369 45.923394))","area_sampling": "True","artifact_name":
      "s1_descending_landslide_2021-10-01_2022-01-01"}'
  image: ghcr.io/tn-aixpa/sentinel-tools:0.11.7
  volumes:
    - name: volume-flood
      spec:
        size: 300Gi
      volume_type: persistent_volume_claim
      mount_path: /app/files
  envs:
    - name: TMPDIR
      value: /app/files
  resources:
    cpu: "6"
    mem: 32Gi
  fs_group: 8877
  secrets:
    - CDSETOOL_ESA_USER
    - CDSETOOL_ESA_PASSWORD
  command: python
  local_execution: false
